#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
åˆ›å»ºç¤ºä¾‹æ–‡çŒ®ç¬”è®°
"""

import os
import json
import sqlite3
from pathlib import Path
from datetime import datetime

def create_sample_literature_note():
    """åˆ›å»ºç¤ºä¾‹æ–‡çŒ®ç¬”è®°"""
    print("=== åˆ›å»ºç¤ºä¾‹æ–‡çŒ®ç¬”è®° ===")
    
    # ç¤ºä¾‹æ–‡çŒ®æ•°æ®
    sample_literature = {
        "title": "åŸºäºæ•™å­¦è¯„ä¸€ä½“åŒ–çš„å°å­¦è‹±è¯­é˜…è¯»æ•™å­¦ä¸­AIæŠ€æœ¯çš„è¿ç”¨",
        "authors": "å´é›ªäº‘",
        "year": "2025",
        "publication": "æ ¡å›­è‹±è¯­",
        "doi": "",
        "abstract": "æœ¬æ–‡æ¢è®¨æ•™å­¦è¯„ä¸€ä½“åŒ–è§†è§’ä¸‹AIæŠ€æœ¯åœ¨å°å­¦è‹±è¯­é˜…è¯»æ•™å­¦ä¸­çš„åº”ç”¨ç­–ç•¥ç ”ç©¶ã€‚é€šè¿‡åˆ†ææ•™å­¦è¯„ä¸€ä½“åŒ–ç†å¿µä¸AIè¾…åŠ©å°å­¦è‹±è¯­é˜…è¯»æ•™å­¦çš„èåˆè·¯å¾„ï¼Œæå‡ºæ„å»ºAIèµ‹èƒ½æ•™å­¦è¯„ä¸€ä½“åŒ–çš„é˜…è¯»æ•™å­¦æ¨¡å¼ã€‚",
        "citekey": "wu2025",
        "itemType": "journalArticle",
        "tags": ["äººå·¥æ™ºèƒ½", "å°å­¦è‹±è¯­", "æ•™å­¦è¯„ä¸€ä½“åŒ–", "é˜…è¯»æ•™å­¦"],
        "collections": ["æ•™è‚²å­¦"],
        "dateAdded": "2025-11-27T06:18:23Z"
    }
    
    # åˆ›å»ºç¬”è®°å†…å®¹
    note_content = f"""# {sample_literature['title']}

**ä½œè€…**: {sample_literature['authors']}
**æœŸåˆŠ**: {sample_literature['publication']}
**å¹´ä»½**: {sample_literature['year']}
**DOI**: {sample_literature['doi']}
**Zoteroé“¾æ¥**: [æ‰“å¼€åœ¨Zoteroä¸­](zotero://select/items/@{sample_literature['citekey']})

## æ–‡çŒ®ä¿¡æ¯
- **ç±»å‹**: {sample_literature['itemType']}
- **æ ‡ç­¾**: {', '.join(sample_literature['tags'])}
- **æ”¶è—å¤¹**: {', '.join(sample_literature['collections'])}
- **æ·»åŠ æ—¥æœŸ**: {sample_literature['dateAdded']}

## æ‘˜è¦
{sample_literature['abstract']}

## å…³é”®è¦ç‚¹
- æ¢è®¨æ•™å­¦è¯„ä¸€ä½“åŒ–ç†å¿µä¸AIæŠ€æœ¯çš„èåˆ
- æå‡ºAIèµ‹èƒ½çš„é˜…è¯»æ•™å­¦æ¨¡å¼
- åˆ†æAIæŠ€æœ¯åœ¨æ•™å­¦å„ç¯èŠ‚çš„åº”ç”¨

## ç ”ç©¶æ–¹æ³•
- ç†è®ºåˆ†æ
- æ¡ˆä¾‹ç ”ç©¶
- å®è·µæ¢ç´¢

## ä¸»è¦å‘ç°
- AIæŠ€æœ¯èƒ½å¤Ÿæå‡é˜…è¯»æ•™å­¦æ•ˆæœ
- æ•™å­¦è¯„ä¸€ä½“åŒ–éœ€è¦ç³»ç»ŸåŒ–è®¾è®¡
- æŠ€æœ¯ä¸æ•™è‚²ç†å¿µæ·±åº¦èåˆæ˜¯å…³é”®

## ä¸ªäººæ€è€ƒ
- è¯¥ç ”ç©¶ä¸ºå°å­¦è‹±è¯­æ•™å­¦æä¾›äº†æ–°æ€è·¯
- AIæŠ€æœ¯çš„åº”ç”¨éœ€è¦è€ƒè™‘æ•™è‚²å®é™…
- æ•™å­¦è¯„ä¸€ä½“åŒ–æ˜¯æœªæ¥å‘å±•æ–¹å‘

## ç›¸å…³æ–‡çŒ®
- [[äººå·¥æ™ºèƒ½ä¸æ•™è‚²èåˆç ”ç©¶]]
- [[å°å­¦è‹±è¯­æ•™å­¦æ–¹æ³•åˆ›æ–°]]
- [[æ•™å­¦è¯„ä¸€ä½“åŒ–å®è·µæ¢ç´¢]]

## å¼•ç”¨æ ¼å¼
```bibtex
@article{{wu2025,
  title={{åŸºäºæ•™å­¦è¯„ä¸€ä½“åŒ–çš„å°å­¦è‹±è¯­é˜…è¯»æ•™å­¦ä¸­AIæŠ€æœ¯çš„è¿ç”¨}},
  author={{å´é›ªäº‘}},
  journal={{æ ¡å›­è‹±è¯­}},
  year={{2025}},
  pages={{130--132}}
}}
```

## æ ‡ç­¾
#æ–‡çŒ®ç¬”è®° #{sample_literature['year']} #{sample_literature['tags'][0]} #å°å­¦è‹±è¯­ #æ•™å­¦è¯„ä¸€ä½“åŒ–

---

*åˆ›å»ºæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}*
*Zotero Key: {sample_literature['citekey']}*
"""
    
    # ä¿å­˜ç¬”è®°
    note_path = Path("E:/ä»“åº“/æ¯•ä¸šè®ºæ–‡/obsidian/AIç¬”è®°/æ–‡çŒ®ç¬”è®°") / f"{sample_literature['authors']}_2025_{sample_literature['title'][:20]}.md"
    with open(note_path, 'w', encoding='utf-8') as f:
        f.write(note_content)
    
    print(f"âœ“ ç¤ºä¾‹æ–‡çŒ®ç¬”è®°å·²åˆ›å»º: {note_path}")
    return note_path

def create_workflow_test_note():
    """åˆ›å»ºå·¥ä½œæµæµ‹è¯•ç¬”è®°"""
    print("\n=== åˆ›å»ºå·¥ä½œæµæµ‹è¯•ç¬”è®° ===")
    
    note_content = """# Obsidian + Zotero å·¥ä½œæµæµ‹è¯•

## ğŸ¯ æµ‹è¯•ç›®æ ‡
éªŒè¯æ–‡çŒ®@zoteroå’Œç¬”è®°obsidiançš„åŒå‘åŒæ­¥åŠŸèƒ½

## ğŸ“‹ æµ‹è¯•é¡¹ç›®

### 1. æ–‡çŒ®ç®¡ç†åœ¨Zotero âœ…
- [x] æ–‡çŒ®æ”¶é›†å’Œå¯¼å…¥
- [x] PDFæ–‡ä»¶ç®¡ç†
- [x] å…ƒæ•°æ®æå–
- [x] åˆ†ç±»å’Œæ ‡ç­¾

### 2. ç¬”è®°æ•´ç†åœ¨Obsidian âœ…
- [x] ç›®å½•ç»“æ„åˆ›å»º
- [x] æ¨¡æ¿æ–‡ä»¶å‡†å¤‡
- [x] æ’ä»¶é…ç½®æŒ‡å—
- [x] å·¥ä½œæµæ–‡æ¡£

### 3. åŒå‘åŒæ­¥åŠŸèƒ½ ğŸ”„
- [ ] PDFæ³¨é‡Šæå–åˆ°Obsidian
- [ ] Obsidiané“¾æ¥åˆ°Zotero
- [ ] å…ƒæ•°æ®è‡ªåŠ¨åŒæ­¥
- [ ] æ–‡çŒ®å…³è”å»ºç«‹

## ğŸ”§ é…ç½®çŠ¶æ€

### Zotfileé…ç½®
- [x] æ’ä»¶å®‰è£…è„šæœ¬å‡†å¤‡
- [ ] æ’ä»¶å®é™…å®‰è£…
- [ ] Tabletæ–‡ä»¶å¤¹è®¾ç½®
- [ ] æ³¨é‡Šæå–é…ç½®

### Obsidianæ’ä»¶
- [x] æ’ä»¶å®‰è£…æŒ‡å—
- [ ] Zotero Integration
- [ ] Dataview
- [ ] Templater
- [ ] QuickAdd

## ğŸ“ æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1: å®‰è£…Zotfileæ’ä»¶
```cmd
E:\ä»“åº“\æ¯•ä¸šè®ºæ–‡\install_zotfile.bat
```

### æ­¥éª¤2: é…ç½®Zotfileè®¾ç½®
1. æ‰“å¼€Zotero
2. å·¥å…· â†’ Zotfile Preferences
3. è®¾ç½®Tabletæ–‡ä»¶å¤¹ä¸º: `E:\ä»“åº“\æ¯•ä¸šè®ºæ–‡\obsidian\AIç¬”è®°\PDFé˜…è¯»`
4. å¯ç”¨æ³¨é‡Šæå–åŠŸèƒ½

### æ­¥éª¤3: å®‰è£…Obsidianæ’ä»¶
1. æ‰“å¼€Obsidian
2. è®¾ç½® â†’ ç¤¾åŒºæ’ä»¶ â†’ æµè§ˆ
3. æœç´¢å¹¶å®‰è£…å¿…éœ€æ’ä»¶
4. é…ç½®æ’ä»¶è®¾ç½®

### æ­¥éª¤4: æµ‹è¯•åŒæ­¥åŠŸèƒ½
1. åœ¨Zoteroä¸­é€‰æ‹©æ–‡çŒ®
2. å³é”® â†’ Manage Attachments â†’ Send to Tablet
3. æ£€æŸ¥PDFæ˜¯å¦ç§»åŠ¨åˆ°Obsidianæ–‡ä»¶å¤¹
4. æ£€æŸ¥æ³¨é‡Šæ˜¯å¦æå–ä¸ºç¬”è®°

## ğŸ¯ é¢„æœŸç»“æœ

### æˆåŠŸæ ‡å‡†
- PDFæ–‡ä»¶è‡ªåŠ¨ç§»åŠ¨åˆ°Obsidian/PDFé˜…è¯»æ–‡ä»¶å¤¹
- PDFæ³¨é‡Šè‡ªåŠ¨æå–ä¸ºObsidianç¬”è®°
- ç¬”è®°åŒ…å«Zoteroé“¾æ¥ï¼Œå¯è·³è½¬å›åŸæ–‡çŒ®
- æ–‡çŒ®å…ƒæ•°æ®æ­£ç¡®æ˜¾ç¤ºåœ¨ç¬”è®°ä¸­

### æ•…éšœæ’é™¤
å¦‚æœåŒæ­¥å¤±è´¥ï¼Œæ£€æŸ¥ï¼š
1. Zotfileæ’ä»¶æ˜¯å¦æ­£ç¡®å®‰è£…
2. Tabletæ–‡ä»¶å¤¹è·¯å¾„æ˜¯å¦æ­£ç¡®
3. Obsidianæ’ä»¶æ˜¯å¦å¯ç”¨
4. æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®

## ğŸ“Š æµ‹è¯•ç»“æœ

### åŸºç¡€è®¾æ–½æµ‹è¯• âœ…
- [x] Zoteroæ•°æ®åº“è¿æ¥æ­£å¸¸
- [x] Obsidianç›®å½•ç»“æ„å®Œæ•´
- [x] æ¨¡æ¿æ–‡ä»¶åˆ›å»ºæˆåŠŸ
- [x] é…ç½®æ–‡ä»¶ç”Ÿæˆ

### é›†æˆæµ‹è¯• ğŸ”„
- [ ] Zotfileæ’ä»¶å®‰è£…
- [ ] Obsidianæ’ä»¶å®‰è£…
- [ ] åŒå‘åŒæ­¥åŠŸèƒ½
- [ ] å®é™…å·¥ä½œæµéªŒè¯

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. æ‰‹åŠ¨å®‰è£…Zotfileæ’ä»¶
2. æ‰‹åŠ¨å®‰è£…Obsidianæ’ä»¶
3. é…ç½®æ’ä»¶è®¾ç½®
4. è¿›è¡Œå®é™…åŒæ­¥æµ‹è¯•
5. ä¼˜åŒ–å·¥ä½œæµç¨‹

---

*åˆ›å»ºæ—¶é—´: 2025-11-27 15:30:24*
*æµ‹è¯•çŠ¶æ€: è¿›è¡Œä¸­*
"""
    
    note_path = Path("E:/ä»“åº“/æ¯•ä¸šè®ºæ–‡/obsidian/AIç¬”è®°/å·¥ä½œæµæµ‹è¯•.md")
    with open(note_path, 'w', encoding='utf-8') as f:
        f.write(note_content)
    
    print(f"âœ“ å·¥ä½œæµæµ‹è¯•ç¬”è®°å·²åˆ›å»º: {note_path}")
    return note_path

def main():
    """ä¸»å‡½æ•°"""
    print("åˆ›å»ºç¤ºä¾‹ç¬”è®°å’Œå·¥ä½œæµæµ‹è¯•æ–‡æ¡£")
    print("=" * 50)
    
    # åˆ›å»ºç¤ºä¾‹æ–‡çŒ®ç¬”è®°
    literature_note = create_sample_literature_note()
    
    # åˆ›å»ºå·¥ä½œæµæµ‹è¯•ç¬”è®°
    workflow_note = create_workflow_test_note()
    
    print("\n" + "=" * 50)
    print("ğŸ‰ ç¤ºä¾‹ç¬”è®°åˆ›å»ºå®Œæˆï¼")
    print("\nå·²åˆ›å»ºçš„æ–‡ä»¶:")
    print(f"1. ç¤ºä¾‹æ–‡çŒ®ç¬”è®°: {literature_note}")
    print(f"2. å·¥ä½œæµæµ‹è¯•ç¬”è®°: {workflow_note}")
    print("\nä¸‹ä¸€æ­¥:")
    print("1. åœ¨Obsidianä¸­æŸ¥çœ‹è¿™äº›ç¬”è®°")
    print("2. æŒ‰ç…§å·¥ä½œæµæµ‹è¯•ç¬”è®°çš„æ­¥éª¤è¿›è¡Œæ“ä½œ")
    print("3. å®Œæˆæ’ä»¶å®‰è£…å’Œé…ç½®")
    print("4. æµ‹è¯•å®é™…çš„åŒæ­¥åŠŸèƒ½")

if __name__ == "__main__":
    main()