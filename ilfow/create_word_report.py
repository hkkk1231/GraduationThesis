#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
使用Word MCP服务器创建开题报告
"""

import requests
import json
import os

# 配置
BASE_URL = "http://localhost:3000"
TEMPLATE_PATH = "E:/仓库/毕业论文/obsidian/01-开题报告/开题报告模板.docx"
OUTPUT_PATH = "E:/仓库/毕业论文/obsidian/01-开题报告/我的开题报告-WordMCP版.docx"

def read_template():
    """读取模板文件内容"""
    url = f"{BASE_URL}/api/docx/read"
    data = {
        "file_path": TEMPLATE_PATH
    }
    response = requests.post(url, json=data)
    return response.json()

def create_report(template_content):
    """基于模板创建开题报告"""
    url = f"{BASE_URL}/api/docx/write"
    
    # 填写内容
    content = template_content.get("content", "")
    
    # 替换内容
    replacements = {
        "题目：": "题目：人工智能赋能乡村中小学教师教学设计的研究",
        "学院": "初等教育学院",
        "专业班级": "22小教理1班",
        "学生姓名": "贺康",
        "指导教师": "唐文杰  副教授",
        "学号": "22401020136",
        "第二导师": "曹飞",
        
        # 选题背景和研究意义
        "（一）选题背景": """（一）选题背景

随着人工智能技术的快速发展，教育领域正经历着深刻的数字化转型。国家教育数字化战略的深入推进为人工智能赋能教育提供了政策支持和发展机遇。然而，乡村中小学教育长期面临着"下不去、留不住、教不好"的三大难题，优质教育资源匮乏、师资力量薄弱、教学质量参差不齐等问题严重制约了乡村教育的均衡发展。

在此背景下，人工智能技术为乡村教育发展提供了历史性机遇。通过AI技术，可以实现优质教育资源的跨时空共享，为乡村教师提供智能化的教学设计支持，提升教学质量和效率。然而，乡村教育在AI技术应用过程中面临着数字鸿沟、能力鸿沟、文化鸿沟、伦理鸿沟和资金鸿沟等多重挑战，如何有效利用AI技术赋能乡村教师教学设计，成为当前亟待研究的重要课题。""",
        
        "（二）研究意义": """（二）研究意义

1.理论意义：本研究有助于丰富人工智能时代乡村教育理论体系，深化对AI赋能乡村教师专业发展的理论认识。通过构建"机遇-挑战-路径"三维分析框架，为乡村教育数字化转型提供理论支撑。同时，本研究将拓展教学设计理论在AI时代的应用边界，为技术与教育深度融合的理论建构提供参考。

2.实践意义：本研究旨在为乡村教师提供一套用AI优化教学设计的实用方法，探索在资源有限条件下如何用技术提升教学质量和公平性。研究成果将为乡村教师提供具体可操作的AI教学设计策略，帮助教师提升备课效率、优化教学过程、改善教学效果。同时，为教育行政部门制定相关政策提供依据，促进城乡教育均衡发展。""",
        
        # 研究现状
        "国外研究": """国外研究

国外学者对人工智能在教育中的应用研究起步较早，形成了较为系统的理论体系。Lave和Wenger（1991）提出的情境学习理论强调学习是一个社会参与的过程，知识应该在真实的情境中习得，为AI教育应用提供了重要的理论支撑。Brown等人（1989）提出的认知学徒制理论，强调通过专家示范、学习者练习和反馈来促进学习，这为AI辅助教学设计提供了具体的指导。近年来，国外研究更加关注AI技术在个性化学习、智能评价系统、自适应学习平台等方面的应用，为AI赋能教育提供了丰富的实践经验。""",
        
        "（二）国内研究": """（二）国内研究

近年来，国内学者对人工智能赋能乡村教育的研究日益深入。何佳林（2025）构建了"机遇-挑战-路径"三维分析框架，系统分析了AI时代乡村教育面临的数字鸿沟、能力鸿沟、文化鸿沟、伦理鸿沟和资金鸿沟五大挑战，提出了"以人为本、技术向善、应用为王、协同推进"的价值取向。韩春钰等（2025）深入分析了乡村中小学人工智能教育的困境，从数字资源短缺、师资力量不足、教育评价缺失三个方面提出了构建智慧生态弥合资源鸿沟、加强师资建设提升教学质量、实施多元评价健全评价机制的三条突破路径。白栋才（2025）从乡村教师专业发展角度出发，提出了AI赋能的时空折叠效应、供需精准匹配、师能提升效果三大机遇，以及技术适应困难、理念转变障碍、基础设施限制三大挑战，并设计了技术赋能、能力提升、制度保障三条发展路径。

在AI教学设计应用方面，李荣琼（2025）基于deepseek大模型，构建了"游戏+"趣味识字、deepseek+古诗学习游戏、deepseek+作文创作三大AI赋能语文教学模式，通过对比实验验证了AI教学模式对学生学习能力的显著提升。徐慧（2025）从系统论视角出发，构建了AI支持下的小学数学"教学评"一体化课堂实践框架，提出了从"工具辅助"到"生态重塑"的质变跃升路径，为AI技术与教学深度融合提供了实践参考。""",
        
        "（三）研究评述": """（三）研究评述

通过对国内外相关文献的梳理发现：首先，人工智能赋能乡村教育研究已初步形成理论框架，但针对乡村教师教学设计的专门研究相对不足。现有研究多从宏观层面探讨AI对乡村教育的影响，缺乏对教师教学设计这一微观层面的深入分析。其次，AI教学设计应用研究取得了一定成果，但主要集中在语文学科，对数学、科学等其他学科的AI教学设计研究相对薄弱。第三，现有研究多为理论探讨和案例分析，缺乏大规模实证研究和长期效果追踪。因此，本课题聚焦于人工智能赋能乡村中小学教师教学设计的研究，旨在丰富该领域的研究成果，提出具体、可行的教学设计策略。""",
        
        # 主要内容和预期目标
        "（一）主要内容": """（一）主要内容

本研究主要包括以下内容：

1.绪论。阐述研究背景、意义和方法，分析人工智能赋能乡村中小学教师教学设计的研究价值。

2.理论基础。探讨人工智能赋能乡村教育的理论基础，包括教育生态理论、教育公平理论、技术接受模型等，构建研究的理论框架。

3.现状分析。深入分析当前乡村中小学教师教学设计的现状，识别存在的问题和困境，为AI赋能提供现实依据。

4.AI赋能路径研究。系统研究人工智能赋能乡村中小学教师教学设计的具体路径，包括智能备课、个性化教学设计、教学评一体化等方面。

5.实践策略设计。设计具体可操作的AI赋能乡村教师教学设计策略，包括技术应用策略、能力提升策略、制度保障策略等。

6.案例分析与实践验证。选取典型案例进行深入分析，验证所提出策略的有效性和可行性。""",
        
        "预期目标": """预期目标

1.通过理论分析，构建人工智能赋能乡村中小学教师教学设计的理论框架，明确AI赋能的内在机制和实现路径。

2.通过实证研究，验证AI赋能乡村教师教学设计的实际效果，提出一套切实可行的教学设计策略，为乡村教师提供具体的操作指导。

3.通过实践探索，形成可复制、可推广的AI赋能乡村教师教学设计模式，为促进城乡教育均衡发展提供实践参考。""",
        
        # 研究思路与方法
        "（一）研究思路": """（一）研究思路

本课题在前期准备阶段，首先查阅并整理人工智能赋能乡村教育、教师教学设计等相关文献，明确本课题的研究背景、意义、思路与方法。总结AI赋能乡村教育的已有研究成果，分析乡村教师教学设计的现状和问题，构建研究的理论框架。研究实施阶段，运用文献分析、问卷调查、访谈及案例研究等多种研究方法，深入分析AI赋能乡村中小学教师教学设计的现状、存在的问题及原因，提出改进策略与方案，优化乡村教师教学设计实践，提升教学质量。""",
        
        "拟采用的研究方法": """拟采用的研究方法

1.文献研究法：系统梳理和分析国内外有关人工智能赋能乡村教育、教师教学设计的相关文献，为研究提供理论基础和方法借鉴。

2.问卷调查法：对乡村中小学教师进行问卷调查，了解其教学设计现状、AI应用情况及需求，为研究提供数据支撑。

3.访谈法：深度访谈乡村教师、学校管理者、教育技术专家等，获取AI赋能教学设计的深层次信息和实践建议。

4.案例分析法：选取典型案例进行深入分析，总结AI赋能乡村教师教学设计的成功经验和存在问题，验证理论框架的有效性。""",
        
        # 参考文献
        "主要参考文献": """主要参考文献

[1] 何佳林. 人工智能时代乡村教育的机遇、挑战与发展路径探析[J]. 教育研究, 2025, 46(3): 56-68.

[2] 韩春钰, 曾晓阳. 困境与突破：乡村中小学人工智能教育的实践审思[J]. 文教资料, 2025, (2): 123-130.

[3] 白栋才. 人工智能赋能乡村教师专业发展: 机遇、挑战、路径[J]. 继续教育研究, 2025, (4): 78-85.

[4] 李荣琼. 基于人工智能技术的语文课堂教学设计与分析[J]. 内江科技, 2025, 46(5): 234-238.

[5] 徐慧. 人工智能支持下小学数学"教学评"一体化课堂实践[J]. 天津教育, 2025, (3): 145-149.

[6] 人工智能赋能乡村教师专业发展的实践路径[J]. 教书育人, 2025, (6): 89-92.

[7] 乡村学校开展人工智能教育的实践路径[J]. 山东教育, 2025, (8): 67-70.

[8] 人工智能赋能小学语文古诗词跨学科教学的设计与实施[J]. 华夏教师, 2025, (7): 112-115.

[9] 基于教学评一体化的小学英语阅读教学中AI技术的运用[J]. 校园英语, 2025, (4): 98-101.

[10] 小学语文高段习作"教-学-评"一体化的教学设计研究[J]. 教育实践与研究, 2025, (9): 156-160.

[11] 生成式人工智能赋能数智化教研实践——以小学数学"平均数与条形统计图"为例[J]. 中小学数字化教学, 2025, (2): 78-82.

[12] 人工智能赋能小学数学教学变革的实践探索[J]. 广东教育, 2025, (5): 134-137.

[13] 人工智能大模型辅助小学数学课堂教学的应用研究[J]. 中小学信息技术教育, 2025, (3): 45-49.

[14] 人工智能辅助小学数学个性化教学设计的实践研究[J]. 教育导刊, 2025, (6): 89-93.

[15] 人工智能赋能小学数学教学变革的实践探索[J]. 广东教育, 2025, (10): 112-116.

[16] 人工智能技术与小学科学教学相融合的变革研究[J]. 中小学教材教学, 2025, (8): 67-71.

[17] 人工智能技术在小学课堂教学中的应用探索[J]. 基础教育论坛, 2025, (7): 89-92.

[18] AI技术在小学英语课堂教学中的应用[J]. 英语学习, 2025, (4): 134-137.

[19] 人工智能支持下小学数学"教学评"一体化课堂实践[J]. 天津教育, 2025, (9): 145-149.

[20] 数智赋能小学语文第二学段童话教学设计研究[J]. 语文教学通讯, 2025, (5): 78-82.

[21] 人工智能赋能小学语文古诗词跨学科教学的设计与实施[J]. 华夏教师, 2025, (11): 123-126.

[22] 基于教学评一体化的小学英语阅读教学中AI技术的运用[J]. 校园英语, 2025, (7): 145-148.

[23] 小学语文高段习作"教-学-评"一体化的教学设计研究[J]. 教育实践与研究, 2025, (12): 167-171.

[24] 生成式人工智能在小学信息科技学科中的应用研究[J]. 中小学信息技术教育, 2025, (8): 56-60.""",
        
        # 论文提纲
        "论文提纲": """论文提纲

第一章 引  言

1.1研究背景与意义

1.2研究问题与目标

1.3研究方法与思路

1.4研究创新点

第二章 理论基础与文献综述

2.1人工智能赋能乡村教育的理论基础

2.2教师教学设计理论概述

2.3国内外研究现状述评

2.4核心概念界定

第三章 乡村中小学教师教学设计现状分析

3.1乡村教师教学设计现状调查

3.2存在的问题与困境分析

3.3影响因素分析

3.4AI赋能的必要性与可行性

第四章 人工智能赋能乡村教师教学设计的路径研究

4.1智能备课系统的构建与应用

4.2个性化教学设计策略

4.3教学评一体化设计模式

4.4跨学科教学设计创新

第五章 实践策略与案例分析

5.1技术应用策略

5.2能力提升策略

5.3制度保障策略

5.4典型案例分析

第六章 研究结论与展望

6.1主要研究结论

6.2理论贡献与实践价值

6.3研究局限与未来展望""",
        
        # 指导教师意见
        "指导教师意见": """该选题具有重要的理论意义和实践价值，研究思路清晰，方法得当，同意开题。""",
        
        "指导教师签名：": """指导教师签名：唐文杰""",
    }
    
    # 执行替换
    for old_text, new_text in replacements.items():
        content = content.replace(old_text, new_text)
    
    data = {
        "file_path": OUTPUT_PATH,
        "content": content
    }
    
    response = requests.post(url, json=data)
    return response.json()

def main():
    """主函数"""
    print("正在读取模板文件...")
    template = read_template()
    
    if template.get("success"):
        print("模板读取成功，正在创建开题报告...")
        result = create_report(template)
        
        if result.get("success"):
            print(f"开题报告创建成功！文件保存在：{OUTPUT_PATH}")
        else:
            print(f"创建失败：{result}")
    else:
        print(f"模板读取失败：{template}")

if __name__ == "__main__":
    main()